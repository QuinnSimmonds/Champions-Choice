# Content-Based Recommender (Sport-Only)

## What Changed?

### Old Approach (Item-Based Collaborative Filtering)
- ❌ Learned: "Product 5 is similar to Product 12"
- ❌ Only worked with exact synthetic product IDs
- ❌ Couldn't recommend for real database products

### New Approach (Content-Based Filtering)
- ✅ Learns: "Soccer products are similar to Basketball products"
- ✅ Works with ANY products that have sport categories
- ✅ Can recommend for your real database products

---

## Files Overview

| File | Purpose |
|------|---------|
| `ContentBasedTraining.ipynb` | Training notebook - run this to generate the model |
| `ContentBasedRecommender.py` | Main recommender class - use this in FastAPI |
| `test_content_recommender.py` | Test script to verify the model works |
| `content_based_artifacts.pkl` | Saved model (generated by training notebook) |

---

## How To Use

### Step 1: Train The Model

Run the `ContentBasedTraining.ipynb` notebook:

```bash
jupyter notebook ContentBasedTraining.ipynb
```

This will:
1. Load your synthetic training data
2. Learn sport-to-sport associations
3. Save `content_based_artifacts.pkl`

### Step 2: Test The Model

```bash
python test_content_recommender.py
```

Verify that recommendations make sense.

### Step 3: Update FastAPI

Replace the old `Recommender` with `ContentBasedRecommender`:

```python
from ContentBasedRecommender import ContentBasedRecommender

# Initialize once at startup
recommender = ContentBasedRecommender("model_artifacts/content_based_artifacts.pkl")

# In your endpoint
@app.get("/recommend/product/{product_id}")
def recommend_for_product(product_id: int):
    # Get product from your database
    product = db.get_product(product_id)
    
    # Get recommendations based on sport
    recommendations = recommender.recommend_for_sport(
        sport=product.sport,
        top_n=10
    )
    
    # Return product names (Spring Boot will look them up)
    return {"recommendations": recommendations}
```

---

## How It Works With Real Products

### Scenario: User views a real product

1. **Spring Boot:** User views "Nike Air Max Running Shoes" (product_id=157, sport="Running")
2. **FastAPI call:** Spring Boot sends `GET /recommend/product/157` with `{sport: "Running"}`
3. **Model logic:**
   - Model knows: "Running buyers also like Fitness (60%), Basketball (40%)"
   - Returns 7 Running products + 2 Fitness products + 1 Basketball product
4. **Spring Boot:** Takes product names, queries database to get full details
5. **Frontend:** Shows "You might also like..." with real products

### Why This Works

- Model learned **sport patterns** from synthetic data
- These patterns are **transferable** to real products
- As long as real products have sport categories, recommendations work

---

## Key Functions

### `recommend_for_sport(sport, top_n)`
Use when: User views a single product
```python
# User viewing a Soccer product
recommendations = recommender.recommend_for_sport("Soccer", top_n=10)
# Returns: 7 Soccer products + 3 associated sport products
```

### `recommend_for_sports(sports, top_n)`
Use when: User has purchase history
```python
# User previously bought Basketball and Football
recommendations = recommender.recommend_for_sports(
    ["Basketball", "Football"], 
    top_n=10
)
# Returns: Products from sports associated with Basketball + Football
```

### `get_sport_associations(sport, top_n)`
Use when: You want to see what sports are related
```python
associations = recommender.get_sport_associations("Soccer", top_n=3)
# Returns: {"Basketball": 0.65, "Football": 0.52, "Tennis": 0.41}
```

---

## What Spring Boot Needs To Send

Your FastAPI endpoints will need:

1. **For product recommendations:**
   - Product's sport category
   
2. **For user recommendations:**
   - List of sports from user's purchase history

3. **Response format:**
```json
{
  "recommendations": [
    {
      "product_name": "Nike Soccer Ball",
      "sport": "Soccer",
      "brand": "Nike"
    },
    ...
  ]
}
```

Spring Boot then looks up these product names in its database to get full details (price, images, stock, etc.).

---

## Next Steps

1. ✅ Train the model (run the notebook)
2. ✅ Test it works (run test script)
3. ⏭️ Update your FastAPI endpoints to use the new recommender
4. ⏭️ Update Spring Boot to send sport information
5. ⏭️ Test the full integration

---

## Advantages of This Approach

✅ **Works with real products** - No need for ID mapping  
✅ **Simple to understand** - Sport-based matching is intuitive  
✅ **Easy to explain in demo** - Clear logic for recommendations  
✅ **Handles new products** - Any product with a sport can be recommended  
✅ **Scalable** - Adding new sports is automatic  

---

## Questions?

**Q: What if my real products have different sport names?**  
A: Make sure sport names match between synthetic data and real database. Or add a mapping layer.

**Q: Can I add more features (brand, price)?**  
A: Yes! The same approach works. Just train on brand associations too.

**Q: What if a product has no sport?**  
A: The model falls back to popular products across all sports.

**Q: Do I need to retrain for real data?**  
A: No! The model learned transferable sport patterns. It works with any products.
